(function(){$.fn.extend({auto_kana_input:function(d){var o,p,q,c,h;null==d&&(d={});o=/^[a-zA-Z]$/;p=/^[\u3041-\u3093\u30a1-\u30f6\u30fc]$/;h=0;c=this.selector;q=d.target||c+"_kana";return this.live("keydown",function(a){var i,d,l,c,f,j,k,g,r,m;i=function(b){var n,e;n=m();e=n.val();return n.val(e+r(b))};c=function(b){return-1!==$.inArray(b.which,[8,13,32,37,38,39,40])};l=function(b){return b.match(p)};d=function(){return m().val("")};m=function(){return $(q)};r=function(b){return b.replace(/[\u3041-\u3093]/g,
function(b){return String.fromCharCode(b.charCodeAt(0)+96)})};f=$(this).val();k=f.length;g=function(b){var d,e,a,c;a=0;for(e=0,c=b.length-1;0<=c?e<=c:e>=c;0<=c?e++:e--)d=b.charAt(e),a=d.match(o)?a+1:a+3;return a}(f);j=f.charAt(k-1);g>h&&l(j)&&!c(a)&&(a=f.charAt(k-2),3<g-h&&l(a)?i(a):a.match(/^[\u3063\u30c3]$/)&&i(a),i(j));0===k&&(d(),g=0);h=g;return j})}})}).call(this);
